schema:
  schema_id: kagiroi
  name: かぎろい
  version: 'v1.0'
  author:
    - pfeiwu <dev.pengfei.wu@gmail.com>
  dependencies:

switches:
  - name: ascii_mode
    reset: 0
    states: [ローマ字, abc ]
  - name: full_shape
    states: [半角, 全角 ]
  - name: ascii_punct
    states: [ 。，, ．， ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
  filters:
    - uniquifier

speller:
  alphabet: abcdefghijklmnopqrstuvwxyz;
  delimiter: " '"  
  algebra:
    # 促音
    # xtu;ta->t;ta xtu;ki;xyo->k;ki;xyo など
    # ここで中の「;」を保留するのは、促音の後に拗音が続く場合に対応するため
    - xform/;xtu;([a-z])([a-z]+);/;$1;$1$2;/
   
    # 開拗音(い)と直音のyの部分 訓令式
    # ki;xya->kya など 
    - xform/;([kgsztdnhbpmr])i;xy?([aiueo]);/;$1y$2;/
    # ji;xe->je
    - xform/;ji;xe;/;je;/
    # shi;xe->she chi;xe->che など
    - xform/;([sc]h)i;xe;/;$1e;/
    # 合拗音(う)と直音のwの部分
    # ku;xwa->kwa
    - xform/;([kgshfv])u;x([aiueo]);/;$1w$2;/

    # 他の拗音
    # to;xya->twa do;xya->dwa など
    - xform/;([td])o;xy?([aiueo]);/;$1w$2;/

    # 拗音 ヘボン式
    # zya->jya,jaなど
    - derive/;zy([aiueo]);/;jy$1;/
    - derive/;jy(.);/;j$1;/
    # sya->sha tya->chaなど
    - derive/;sy([auo]);/;sh$1;/
    - derive/;ty([auo]);/;ch$1;/    

    # 五十音 ヘボン式
    # si->shi 
    - derive/;si;/;shi;/
    # ti->chi 
    - derive/;ti;/;chi;/
    # tu->tsu xtu->xtsu 
    - derive/;(x?)tu;/;$1tsu;/
    # du->zu 
    - derive/;du;/;zu;/
    # hu->fu 
    - derive/;hu;/;fu;/
    # zi/di->ji 
    - derive/;[zd]i;/;ji;/
  
   # lで捨て仮名
    # xa -> la xya -> lya xtsu -> ltsu など
    - derive/;x([a-z]{1,3});/;l$1;/

    # んを一文字
    # - derive/;nn;(?!aiueoy)/;n;/

    # 区切りを消す
    - xform/;//
    
    # コードだけを残す
    - erase/^.*[^a-z].*$/


translator:
  dictionary: kagiroi
  prism: kagiroi
  enable_completion: false
  enable_sentence: false
  comment_format:
    - xform/.*//
punctuator:
  import_preset: default

recognizer:
  import_preset: default

key_binder:
  import_preset: default